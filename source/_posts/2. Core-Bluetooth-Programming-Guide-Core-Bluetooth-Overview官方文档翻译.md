---
title: 2. Core Bluetooth Programming Guide - Core Bluetooth Overview 官方文档翻译
date: 2017-10-16 18:11:01
tags:
---
官方文档地址:  [Core Bluetooth Programming Guide](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/AboutCoreBluetooth/Introduction.html#//apple_ref/doc/uid/TP40013257-CH1-SW1)

# Core Bluetooth 概述

Core Bluetooth框架让你的iOS和Mac应用和低功耗蓝牙设备进行通讯，例如，你的设备可以发现，浏览，与BLE外部设备进行交互，例如心律仪，电子温度控制器，甚至是iOS设备。

Core Bluetooth框架是使用BLE设备时对于蓝牙4.0标准的抽象。这就是说，它为你屏蔽了许多底层标准的细节，让你开发与BLE设备交互的App时更加容易。因为这个框架是基于这一标准，标准中的一些概念和专业术语依然被采用。这章为你介绍了一些专业术语和概念，而且这些都是在你使用Core Bluetooth进行开发之前需要知道的。

**重要:** iOS 10之后的iOS应用必须在`Info.plist`文件中必须添加[NSBluetoothPeripheralUsageDescription](https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW20)如果你不写的话，你的App就会崩溃。

 An iOS app linked on or after iOS 10.0 must include in its `Info.plist` file the usage description keys for the types of data it needs to access or it will crash. To access Bluetooth peripheral data specifically, it must include [NSBluetoothPeripheralUsageDescription](https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW20). 谁帮我翻译一下这段(≧Д≦)

## 中央设备、外部设备和他们在蓝牙通信中扮演的角色

在蓝牙通讯中有两个主要的角色：中心设备和外部设备。基于传统的客户端-服务器架构，一个外部设备通常会有一些其他设备需要的数据。中心设备通常使用外部设备提供的数据去完成一些特定的任务，如图1-1所示，例如，一个心率仪有一些有用的数据，这些数据对Mac和iOS应用可能需要把这些数据以一种有好的方式显示出来。

**Figure 1-1**  Central and peripheral devices 中心设备和外部设备![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/CBDevices1_2x.png)

### 中央设备发现并且连接正在广告（advertising: 信息更新时以指定的间隔发出）的外部设备

外部设备会广播一些数据，这些数据一广告信息报的形式发送。一个广告信息包是一个相关的数据集，这里面可能包含一些外围设备提供的有用的信息，比如说外围设备的名字和他的主要功能。例如，一个电子温度调节器可能会提供房间的当前温度，在低功耗蓝牙中，广告是使外设能够被发现的主要方法。

另一方面，中央设备能够扫描并且监听任何正在广告的外围设备，如图1-2所示，中央设备可以请求去连接任何被发现正在广告的外围设备

**Figure 1-2**  Advertising and discovery 广告（外围设备）和发现（中央设备）![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/AdvertisingAndDiscovery_2x.png)

### 外设的数据是怎么结构化的

连接外围设备的目的是开始浏览外围设备并且与外围设备提供的数据进行的交互，在你能够做到之前，他能够帮助你理解外围设备的数据是怎么结构化的。

外围设备可能包含一个或者多个Services(服务)或者提供一些关于信号强度信息的游泳信息。一个服务包含数据的集合，这些数据与设备（或者设备的局部）的特征和它完成的功能有紧密的关系。例如心率检测仪的传感器收集到数据，然后心率监测仪一个服务Service就可能会发送心率的数据。

Services themselves are made up of either characteristics or included services (that is, references to other services). A *characteristic* provides further details about a peripheral’s service. For example, the heart rate service just described may contain one characteristic that describes the intended body location of the device’s heart rate sensor and another characteristic that transmits heart rate measurement data. Figure 1-3illustrates one possible structure of a heart rate monitor’s service and characteristics.

这段翻译不出来，英文好的朋友帮帮忙啊~~~~~~~~~~~~~

**Figure 1-3**  A peripheral’s service and characteristics![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/CBPeripheralData_Example_2x.png)

### 中央设备查看和与外围设备数据交互

当中心设备成功的与外围设备建立了连接，他可以发现外围设备提供的所有的service（服务）和charactoristic（特征值）（广告数据可能只是提供服务中数据的一小部分）

中心设备也可以通过读写服务的特征值来和外围设备进行交互。例如，你的应用请求数码测温计当前室内温度，你也可以给温度调节器设置一个值来调整是内的温度。

## 中心设备外围设备和外围设备的数据是怎么呈现的

中心设备外围设备和BLE的通讯数据以一种简单直接的方式映射（map）到Core Bluetooth框架中。

### Objects on the Central Side

当你使用中心设备与远端的外围设备进行交互的时候，你在中心设备端进行一些蓝牙通讯的操作，除非是你设置的外围设备或者对中心设备的尽情反馈，其他大部分蓝牙通讯都发生在中心设备这部分。

关于怎么在你的app上实现中心设备的角色，请参阅[Performing Common Central Role Tasks](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/PerformingCommonCentralRoleTasks/PerformingCommonCentralRoleTasks.html#//apple_ref/doc/uid/TP40013257-CH3-SW1) 和 [Best Practices for Interacting with a Remote Peripheral Device](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/BestPracticesForInteractingWithARemotePeripheralDevice/BestPracticesForInteractingWithARemotePeripheralDevice.html#//apple_ref/doc/uid/TP40013257-CH6-SW1)



#### 本地中心设备和远程外围设备

在中心设备这一端，中心设备是用`CBCentralManager`类来体现的。这些类用来管理发现和连接远程的外围设备（外围设备是由`CBPeripheral`l来体现的），也包括扫描，发现，连接到广告设备。图1-4显示中心设备和外围设备是怎么在Core Bluetooth框架中展示的。

**Figure 1-4**  Core Bluetooth objects on the central side 中心设备端口的Core Bluetooth 类![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/CBObjects_CentralSide_2x.png)

####  远程的外围设备由CBService和CBCharacteristic类来呈现

当你和远程外围设备（由 `CBPeripheral` 来呈现）进行数据交互的时候，其实你就是在处理它的服务（service）和特征值（characteristic）。在Core Bluetooth框架中，远程外围设备的服务是由 `CBService` 这个类来呈现的。相似的，特征值是由`CBCharacteristic`来呈现的。图1-5说明了远程外围设备的服务和特征值的基础结构。

**Figure 1-5**  A remote peripheral’s tree of services and characteristics![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/TreeOfServicesAndCharacteristics_Remote_2x.png)

### 外围设备端的类

从macOS 10.9和iOS 6开始，Mac和iOS设备可以被当做BLE（低功耗蓝牙）设备，提供给其他包括Mac，iPhone和iPad在内的设备数据。当你把你的设备当做外围设备，你就在BLE设备通讯中执行一些作为外围设备的操作。

#### Local Peripherals and Remote Centrals

On the peripheral side, a local peripheral device is represented by a `CBPeripheralManager` object. These objects are used to manage published services within the local peripheral device’s database of services and characteristics and to advertise these services to remote central devices (represented by `CBCentral` objects). Peripheral manager objects are also used to respond to read and write requests from these remote centrals. Figure 1-6 shows how local peripherals and remote centrals are represented in the Core Bluetooth framework.

**Figure 1-6**  Core Bluetooth objects on the peripheral side![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/CBObjects_PeripheralSide_2x.png)

#### 本地外围设备的数据是由CBMutableService 和 CBMutableCharacteristic两个类呈现的

When you are setting up and interacting with the data on a local peripheral (represented by a `CBPeripheralManager` object), you are dealing with mutable versions of its services and characteristics. In the Core Bluetooth framework, the services of a local peripheral are represented by `CBMutableService` objects. Similarly, the characteristics of a local peripheral’s service are represented by `CBMutableCharacteristic` objects. Figure 1-7 illustrates the basic structure of a local peripheral’s services and characteristics.

当你在外围设备上

**Figure 1-7**  A local peripheral’s tree of services and characteristics![img](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/Art/TreeOfServicesAndCharacteristics_Local_2x.png)

寻找更多让你的设备变成外围设备的信息，请参阅[Performing Common Peripheral Role Tasks](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/PerformingCommonPeripheralRoleTasks/PerformingCommonPeripheralRoleTasks.html#//apple_ref/doc/uid/TP40013257-CH4-SW1) 和 [Best Practices for Setting Up Your Local Device as a Peripheral](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/BestPracticesForSettingUpYourIOSDeviceAsAPeripheral/BestPracticesForSettingUpYourIOSDeviceAsAPeripheral.html#//apple_ref/doc/uid/TP40013257-CH5-SW1).

## 相关连接：
[1. Introduction - 介绍](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/AboutCoreBluetooth/Introduction.html#//apple_ref/doc/uid/TP40013257-CH1-SW1)
[2. Core Bluetooth Overview - 概述](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/CoreBluetoothOverview/CoreBluetoothOverview.html#//apple_ref/doc/uid/TP40013257-CH2-SW1)
[3. Performing Common Central Role Tasks - 执行通用中央设备的任务](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/PerformingCommonCentralRoleTasks/PerformingCommonCentralRoleTasks.html#//apple_ref/doc/uid/TP40013257-CH3-SW1)
[4. Performing Common Peripheral Role Tasks - 执行通用外部设备的任务](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/PerformingCommonPeripheralRoleTasks/PerformingCommonPeripheralRoleTasks.html#//apple_ref/doc/uid/TP40013257-CH4-SW1)
[5. Core Bluetooth Background Processing for iOS Apps - iOS App 使用Core Bluetooth时的后台模式的处理](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/CoreBluetoothBackgroundProcessingForIOSApps/PerformingTasksWhileYourAppIsInTheBackground.html#//apple_ref/doc/uid/TP40013257-CH7-SW1)
[6. Best Practices for Interacting with a Remote Peripheral Device - 与远程外设交互的最佳实践](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/BestPracticesForInteractingWithARemotePeripheralDevice/BestPracticesForInteractingWithARemotePeripheralDevice.html#//apple_ref/doc/uid/TP40013257-CH6-SW1)
[7. Best Practices for Setting Up Your Local Device as a Peripheral - 作为外设建立起本地设备的最佳实践](https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/CoreBluetooth_concepts/BestPracticesForSettingUpYourIOSDeviceAsAPeripheral/BestPracticesForSettingUpYourIOSDeviceAsAPeripheral.html#//apple_ref/doc/uid/TP40013257-CH5-SW1)
